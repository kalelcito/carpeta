CREATE TABLE certificado (id_certificado BIGINT AUTO_INCREMENT, nombre VARCHAR(128), descripcion VARCHAR(250), PRIMARY KEY(id_certificado)) ENGINE = INNODB;
CREATE TABLE comite (id_comite BIGINT AUTO_INCREMENT, id_unidad BIGINT, nombre_comite VARCHAR(128), id_usuario_presidente BIGINT, creado DATETIME, actualizado DATETIME NOT NULL, created_at DATETIME NOT NULL, INDEX id_unidad_idx (id_unidad), INDEX id_usuario_presidente_idx (id_usuario_presidente), PRIMARY KEY(id_comite)) ENGINE = INNODB;
CREATE TABLE direccion (id_direccion BIGINT AUTO_INCREMENT, pais VARCHAR(64) NOT NULL, estado VARCHAR(64) NOT NULL, ciudad VARCHAR(128) NOT NULL, municipio VARCHAR(128) NOT NULL, delegacion VARCHAR(128) NOT NULL, direccion TEXT NOT NULL, referencia TEXT NOT NULL, numero VARCHAR(11) NOT NULL, cp VARCHAR(11) NOT NULL, id_unidad BIGINT NOT NULL, id_empresa BIGINT NOT NULL, PRIMARY KEY(id_direccion)) ENGINE = INNODB;
CREATE TABLE empresa (id_empresa BIGINT AUTO_INCREMENT, nombre_empresa VARCHAR(250), logo TEXT, nombre_contacto VARCHAR(240), email VARCHAR(250), telefono VARCHAR(50), activar_sucursales TINYINT(1), tipo TINYINT(1), pais VARCHAR(64), estado VARCHAR(64), ciudad VARCHAR(128), municipio VARCHAR(128), numero VARCHAR(11), direccion TEXT, delegacion VARCHAR(128), cp VARCHAR(11), referencia TEXT, creado DATETIME NOT NULL, actualizado DATETIME NOT NULL, PRIMARY KEY(id_empresa)) ENGINE = INNODB;
CREATE TABLE programa (id_programa BIGINT AUTO_INCREMENT, id_requisito BIGINT NOT NULL, id_comite BIGINT, nombre VARCHAR(128), coordinador VARCHAR(150), calificacion DECIMAL(3, 2), fecha_elaboracion DATE, fecha_revision DATE, id_usuario_elaboro BIGINT, id_consultor BIGINT, fecha_compromiso DATE, no_revision BIGINT, id_usuario_reviso BIGINT, id_usuario_modifico BIGINT, fecha_modifico DATE, creado DATETIME NOT NULL, actualizado DATETIME NOT NULL, INDEX id_requisito_idx (id_requisito), INDEX id_comite_idx (id_comite), PRIMARY KEY(id_programa)) ENGINE = INNODB;
CREATE TABLE requisito (id_requisito BIGINT AUTO_INCREMENT, titulo TEXT NOT NULL, descripcion TEXT, guia_de_apoyo TEXT, PRIMARY KEY(id_requisito)) ENGINE = INNODB;
CREATE TABLE seccion10 (id_ps BIGINT AUTO_INCREMENT, id_programa BIGINT, id_seccion BIGINT, id_usuario_creo BIGINT, comentario TEXT, creado DATE, INDEX id_programa_idx (id_programa), PRIMARY KEY(id_ps)) ENGINE = INNODB;
CREATE TABLE seccion5 (id_ps BIGINT AUTO_INCREMENT, id_programa BIGINT, id_seccion BIGINT, directivos VARCHAR(5), personalno_sin VARCHAR(5), personal_sin VARCHAR(5), t_personal VARCHAR(5), f_personal VARCHAR(5), o_grupos VARCHAR(5), text_otros VARCHAR(150), creado DATE, INDEX id_programa_idx (id_programa), PRIMARY KEY(id_ps)) ENGINE = INNODB;
CREATE TABLE seccion6 (id_ps BIGINT AUTO_INCREMENT, id_programa BIGINT, id_seccion BIGINT, tablero VARCHAR(5), circular VARCHAR(5), correo VARCHAR(5), informe VARCHAR(5), informal VARCHAR(5), otro_medio VARCHAR(5), text_otro VARCHAR(150), creado DATE, INDEX id_programa_idx (id_programa), PRIMARY KEY(id_ps)) ENGINE = INNODB;
CREATE TABLE seccion8 (id_ps BIGINT AUTO_INCREMENT, id_seccion BIGINT, id_programa BIGINT, id_usuario_creo BIGINT, p_d BIGINT, t_p_d VARCHAR(250), p_a BIGINT, t_p_a VARCHAR(250), p_c BIGINT, t_p_c VARCHAR(250), p_p BIGINT, t_p_p VARCHAR(250), p_o BIGINT, t_p_o VARCHAR(250), d_d BIGINT, t_d_d VARCHAR(250), d_a BIGINT, t_d_a VARCHAR(250), d_c BIGINT, t_d_c VARCHAR(250), d_p BIGINT, t_d_p VARCHAR(250), d_o BIGINT, t_d_o VARCHAR(250), e_d BIGINT, t_e_d VARCHAR(250), e_a BIGINT, t_e_a VARCHAR(250), e_c BIGINT, t_e_c VARCHAR(250), e_p BIGINT, t_e_p VARCHAR(250), e_o BIGINT, t_e_o VARCHAR(250), r_d BIGINT, t_r_d VARCHAR(250), r_a BIGINT, t_r_a VARCHAR(250), r_c BIGINT, t_r_c VARCHAR(250), r_p BIGINT, t_r_p VARCHAR(250), r_o BIGINT, t_r_o VARCHAR(250), fecha_creado DATE, porcentaje BIGINT, INDEX id_ps_idx (id_ps), INDEX id_programa_idx (id_programa), PRIMARY KEY(id_ps)) ENGINE = INNODB;
CREATE TABLE seccion9 (id_ps BIGINT AUTO_INCREMENT, id_programa BIGINT, id_seccion BIGINT, id_usuario_creo BIGINT, indicador TEXT, ind_a1a VARCHAR(50), ind_a2a VARCHAR(50), ind_a3a VARCHAR(50), indicador2 TEXT, ind_a1b VARCHAR(50), ind_a2b VARCHAR(50), ind_a3b VARCHAR(50), indicador3 TEXT, ind_a1c VARCHAR(50), ind_a2c VARCHAR(50), ind_a3c VARCHAR(50), creado DATE, INDEX id_programa_idx (id_programa), PRIMARY KEY(id_ps)) ENGINE = INNODB;
CREATE TABLE semaforo (id_semaforo BIGINT AUTO_INCREMENT, id_unidad_negocio BIGINT, id_certificado BIGINT, id_certificado_proceso BIGINT, calificacion DECIMAL(3, 2), horas_acordadas BIGINT, tiempo_presencial BIGINT, tiempo_virtual BIGINT, comentarios_gerente TEXT, comentarios_resultado TEXT, auditoria_interna DATE, auditoria_proxima DATE, url_semaforo VARCHAR(250), creado DATETIME NOT NULL, actualizado DATETIME NOT NULL, PRIMARY KEY(id_semaforo)) ENGINE = INNODB;
CREATE TABLE usuario (id_usuario BIGINT AUTO_INCREMENT, id_empresa BIGINT, id_grupo BIGINT, id_unidad BIGINT, id_comite BIGINT, foto TEXT, nombre VARCHAR(128), nombre_usuario VARCHAR(64) UNIQUE, primer_apellido VARCHAR(64), segundo_apellido VARCHAR(64), email VARCHAR(250), telefono_fijo VARCHAR(20), telefono_celular VARCHAR(20), email_emergencia VARCHAR(200), cargo VARCHAR(64), password VARCHAR(64), salt VARCHAR(64), palabra_clave VARCHAR(30), activo TINYINT(1) DEFAULT '1', tipo TINYINT DEFAULT 0, creado DATETIME NOT NULL, actualizado DATETIME NOT NULL, INDEX id_grupo_idx (id_grupo), INDEX id_empresa_idx (id_empresa), INDEX id_unidad_idx (id_unidad), INDEX id_comite_idx (id_comite), PRIMARY KEY(id_usuario)) ENGINE = INNODB;
CREATE TABLE certificado_seccion (id_seccion BIGINT AUTO_INCREMENT, id_certificado BIGINT, titulo VARCHAR(128), descripcion TEXT, calificacion DECIMAL(3, 2), PRIMARY KEY(id_seccion)) ENGINE = INNODB;
CREATE TABLE comite_usuarios (id_usuario BIGINT, id_comite BIGINT, cargo_comite VARCHAR(45), fecha_agregado DATE, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id_usuario, id_comite)) ENGINE = INNODB;
CREATE TABLE programa_anexos (id_anexo BIGINT AUTO_INCREMENT, id_programa BIGINT, url VARCHAR(250), tipo_archivo VARCHAR(8), comentarios TEXT, creado DATETIME NOT NULL, actualizado DATETIME NOT NULL, PRIMARY KEY(id_anexo, id_programa)) ENGINE = INNODB;
CREATE TABLE programa_seccion (id_ps BIGINT AUTO_INCREMENT, id_programa BIGINT NOT NULL, id_seccion BIGINT NOT NULL, id_usuario_creo BIGINT, text_content TEXT, comentario_consultor TEXT, revision TINYINT, activo TINYINT DEFAULT '1', creado DATETIME NOT NULL, actualizado DATETIME NOT NULL, INDEX id_programa_idx (id_programa), PRIMARY KEY(id_ps)) ENGINE = INNODB;
CREATE TABLE region (id_region INT UNIQUE AUTO_INCREMENT, nombre VARCHAR(200), PRIMARY KEY(id_region)) ENGINE = INNODB;
CREATE TABLE unidad (id_unidad BIGINT AUTO_INCREMENT, id_empresa BIGINT NOT NULL, id_usuario BIGINT NOT NULL, id_consultor BIGINT, id_gerente BIGINT, id_subdirector BIGINT, id_director_general BIGINT, logo TEXT, id_region INT, nombre VARCHAR(250), sucursal VARCHAR(128), nombre_contacto VARCHAR(240), email VARCHAR(250), telefono VARCHAR(50), pais VARCHAR(64), estado VARCHAR(64), ciudad VARCHAR(128), municipio VARCHAR(128), direccion TEXT, numero VARCHAR(11), delegacion VARCHAR(128), cp VARCHAR(11), referencia TEXT, creado DATETIME NOT NULL, actualizado DATETIME NOT NULL, INDEX id_empresa_idx (id_empresa), INDEX id_usuario_idx (id_usuario), INDEX id_region_idx (id_region), INDEX id_consultor_idx (id_consultor), INDEX id_gerente_idx (id_gerente), INDEX id_subdirector_idx (id_subdirector), INDEX id_director_general_idx (id_director_general), PRIMARY KEY(id_unidad)) ENGINE = INNODB;
CREATE TABLE usuario_grupo (id_grupo BIGINT AUTO_INCREMENT, nombre VARCHAR(64), permisos TEXT, PRIMARY KEY(id_grupo)) ENGINE = INNODB;
ALTER TABLE comite ADD CONSTRAINT comite_id_usuario_presidente_usuario_id_usuario FOREIGN KEY (id_usuario_presidente) REFERENCES usuario(id_usuario);
ALTER TABLE comite ADD CONSTRAINT comite_id_unidad_unidad_id_unidad FOREIGN KEY (id_unidad) REFERENCES unidad(id_unidad) ON DELETE CASCADE;
ALTER TABLE programa ADD CONSTRAINT programa_id_requisito_requisito_id_requisito FOREIGN KEY (id_requisito) REFERENCES requisito(id_requisito) ON DELETE CASCADE;
ALTER TABLE programa ADD CONSTRAINT programa_id_comite_comite_id_comite FOREIGN KEY (id_comite) REFERENCES comite(id_comite) ON DELETE CASCADE;
ALTER TABLE seccion10 ADD CONSTRAINT seccion10_id_programa_programa_id_programa FOREIGN KEY (id_programa) REFERENCES programa(id_programa) ON DELETE CASCADE;
ALTER TABLE seccion5 ADD CONSTRAINT seccion5_id_programa_programa_id_programa FOREIGN KEY (id_programa) REFERENCES programa(id_programa) ON DELETE CASCADE;
ALTER TABLE seccion6 ADD CONSTRAINT seccion6_id_programa_programa_id_programa FOREIGN KEY (id_programa) REFERENCES programa(id_programa) ON DELETE CASCADE;
ALTER TABLE seccion8 ADD CONSTRAINT seccion8_id_programa_programa_id_programa FOREIGN KEY (id_programa) REFERENCES programa(id_programa) ON DELETE CASCADE;
ALTER TABLE seccion9 ADD CONSTRAINT seccion9_id_programa_programa_id_programa FOREIGN KEY (id_programa) REFERENCES programa(id_programa) ON DELETE CASCADE;
ALTER TABLE usuario ADD CONSTRAINT usuario_id_unidad_unidad_id_unidad FOREIGN KEY (id_unidad) REFERENCES unidad(id_unidad);
ALTER TABLE usuario ADD CONSTRAINT usuario_id_grupo_usuario_grupo_id_grupo FOREIGN KEY (id_grupo) REFERENCES usuario_grupo(id_grupo) ON DELETE RESTRICT;
ALTER TABLE usuario ADD CONSTRAINT usuario_id_empresa_empresa_id_empresa FOREIGN KEY (id_empresa) REFERENCES empresa(id_empresa) ON DELETE RESTRICT;
ALTER TABLE usuario ADD CONSTRAINT usuario_id_comite_comite_id_comite FOREIGN KEY (id_comite) REFERENCES comite(id_comite);
ALTER TABLE comite_usuarios ADD CONSTRAINT comite_usuarios_id_usuario_usuario_id_usuario FOREIGN KEY (id_usuario) REFERENCES usuario(id_usuario);
ALTER TABLE comite_usuarios ADD CONSTRAINT comite_usuarios_id_comite_comite_id_comite FOREIGN KEY (id_comite) REFERENCES comite(id_comite);
ALTER TABLE programa_anexos ADD CONSTRAINT programa_anexos_id_programa_programa_id_programa FOREIGN KEY (id_programa) REFERENCES programa(id_programa) ON DELETE CASCADE;
ALTER TABLE programa_seccion ADD CONSTRAINT programa_seccion_id_programa_programa_id_programa FOREIGN KEY (id_programa) REFERENCES programa(id_programa) ON DELETE CASCADE;
ALTER TABLE unidad ADD CONSTRAINT unidad_id_usuario_usuario_id_usuario FOREIGN KEY (id_usuario) REFERENCES usuario(id_usuario) ON DELETE RESTRICT;
ALTER TABLE unidad ADD CONSTRAINT unidad_id_subdirector_usuario_id_usuario FOREIGN KEY (id_subdirector) REFERENCES usuario(id_usuario);
ALTER TABLE unidad ADD CONSTRAINT unidad_id_region_region_id_region FOREIGN KEY (id_region) REFERENCES region(id_region);
ALTER TABLE unidad ADD CONSTRAINT unidad_id_gerente_usuario_id_usuario FOREIGN KEY (id_gerente) REFERENCES usuario(id_usuario);
ALTER TABLE unidad ADD CONSTRAINT unidad_id_empresa_empresa_id_empresa FOREIGN KEY (id_empresa) REFERENCES empresa(id_empresa) ON DELETE CASCADE;
ALTER TABLE unidad ADD CONSTRAINT unidad_id_director_general_usuario_id_usuario FOREIGN KEY (id_director_general) REFERENCES usuario(id_usuario);
ALTER TABLE unidad ADD CONSTRAINT unidad_id_consultor_usuario_id_usuario FOREIGN KEY (id_consultor) REFERENCES usuario(id_usuario);
